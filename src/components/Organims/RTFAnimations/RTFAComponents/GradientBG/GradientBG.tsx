// @ts-nocheck
"use client";
import { ScrollScene, UseCanvas } from "@14islands/r3f-scroll-rig";
import { useLayoutEffect, useRef } from "react";
import {
  MeshDistortMaterial,
  GradientTexture,
  MeshReflectorMaterial,
} from "@react-three/drei";
import * as THREE from "three";
import gsap from "gsap";

export default function GradientBG({ children, className }: any) {
  const el = useRef<any>();
  const geometry = useRef<any>();
  const content1 = useRef<any>();
  const shperes = [
    [-0.2169715144817282, 0.5062906957496962, -1.8621348555941428],
    [-0.2786327470302538, 0.44118740060656636, -6.250301044889039],
    [0.12124485707748367, -0.4391336669724057, -6.624263033156328],
    [-0.027673489397977313, 0.46774004380130285, -2.4663546530981604],
    [0.6730436091689749, 0.5580908027540856, -3.927093344746968],
    [0.1661384296360352, 0.43009430726550013, -8.031117691430605],
    [-0.15825381448223985, 0.47335193463498304, -4.982556195825374],
    [-0.6674404856496309, 0.07460391542418643, -5.92669468679275],
    [0.6006325836460455, 0.2976937446829544, -9.233281154911312],
    [0.48968896957281594, 0.4393394992416402, 0.630645232128703],
    [-0.31891937994503317, -0.4520499133961622, 2.1917511707016866],
    [-0.5125630069312997, 0.3378125466086108, -0.9052774083219166],
    [0.4044658400794925, 0.5133407099455127, -1.649264307918937],
    [0.22551461243733228, -0.17498489489110725, -4.423766544204815],
    [0.2022868282090926, -0.6108325266577446, -3.415028872442475],
    [-0.3775900533758575, -0.4441501047909049, -2.926842957583326],
    [-0.4098215999126888, 0.5499175677085351, -4.540376008201125],
    [0.5278080718621425, -0.014199663618697955, -6.593319396761021],
    [0.4029290198532882, -0.5316376907473574, -2.3006555508604642],
    [-0.5704202533795915, 0.5009695126344309, -5.651908096699555],
    [-0.06604080624045539, -0.48531083544345754, -5.320950013136341],
    [0.005919471697497292, -0.37231788915775993, -8.93706848345234],
    [0.5733231198533937, -0.5826416868386189, -5.0822319025831195],
    [-0.0768383309527535, 0.4699014999672586, -4.399079475859773],
    [0.1465311579006784, -0.4684324377639809, -3.7912148128273673],
    [-0.5409489007879678, -0.4056649886161719, -4.573470327163484],
    [0.4575038141714667, 0.1661061156904543, -6.928065663567699],
    [-0.3972691560112354, 0.6641251053581538, -6.743417234755217],
    [0.2733392329940868, 0.6013105094186815, -5.906527250945962],
    [-0.23437658922486093, 0.018067274313932402, -0.8420690209194961],
    [-0.006346603503392112, -0.05107170286161267, -3.1406616203546283],
    [0.41534339165442646, -0.477316650102603, -1.6368834197416169],
    [0.6964139626684767, -0.00702607821827117, 0.32045272351745235],
    [-0.35230568936078854, 0.20597152950208375, -1.9130897070369774],
    [0.1534639415107908, 0.14733735751845123, 0.9410847549039694],
    [-0.15081470129098762, -0.20515948252455046, -1.3508076766021828],
    [-0.026187273357149765, -0.3894616018458956, -7.082432135492169],
    [0.6875959858935969, -0.07048770100735724, -7.7948872110943395],
    [-0.40681618777108763, 0.37594794619213867, -3.0868474761436717],
    [-0.6880555746818939, -0.08131339365941836, -2.603383756828472],
    [-0.2755516168753743, -0.010467607782036703, -0.9427587968175832],
    [0.20301043746507286, -0.3712647293677199, -7.746699139315741],
    [0.2498962421326394, -0.03941552093781242, -2.1621204668775635],
    [-0.6603099381228714, -0.5860544707542802, -6.1234819942148695],
    [-0.5364408450142539, -0.5206366148042726, -3.577847409213436],
    [-0.13198643168373136, 0.45041621603921245, -8.406390527803715],
    [-0.08416700426241175, -0.09573978265748839, -2.206963504244742],
    [0.17061119618087306, -0.29322635753909, -1.4738720113020505],
    [0.3795788617184488, 0.07079944496438673, -7.164936953415945],
    [0.22054913027586331, -0.4967782588186316, -2.0551221296187103],
    [0.1975471750823694, -0.4451789288617797, -0.5567748896734983],
    [-0.006364981343821796, -0.3620782833986314, -5.087224734214508],
    [-0.04422190629861422, 0.622014123911516, -0.10067173871992452],
    [0.5451814515138154, 0.6587538540851903, -2.2220674408188246],
    [0.6713136946215361, 0.22755422148572635, -3.257208171107492],
    [-0.3730509183617654, -0.1658389275004415, -5.515519245795874],
    [-0.34619356059656337, -0.2889950545048213, -7.050169945749215],
    [0.5281327386697576, -0.04276575478375966, -6.347250968128236],
    [0.426747802999339, -0.13947772439001271, -0.7273128631678609],
    [-0.019833519132731015, -0.6673114403096185, -7.419511035833751],
    [0.585671175920857, 0.40962774724567397, -1.9305572700942986],
    [0.21550334543843175, -0.2308518383104194, -3.7108488067799925],
    [0.371896631520219, 0.32707533557464274, -1.751953904436306],
    [0.3193897248102726, -0.19631700820637965, -2.0387573114775117],
    [-0.16663466504505842, 0.4927541547707641, -6.54431213788464],
    [-0.0015973628716143828, 0.5696155961690361, -2.923509728486408],
    [0.5652667132639297, 0.5691663805661478, -9.161637673271539],
    [0.31609273851850106, -0.26482599527591, 1.8459547422181415],
    [0.14082685323057909, -0.4187495660028581, -8.54808519958636],
    [-0.5023426216074582, -0.05984174299780254, -2.504636763743565],
    [0.1824488516316547, 0.006122955567474664, 0.963397590917768],
    [0.08928188129775494, -0.6156843554432203, -2.678808884770735],
    [-0.17107156865631323, -0.6773788345860539, -6.2526185719655345],
    [-0.20859406993622187, 0.46236931257865743, -7.2591721575677735],
    [0.11568212378107456, 0.5159127581616485, -0.2607109120437845],
    [-0.36790752143992594, -0.4565189662429799, 0.25413047188840165],
    [-0.2431375901402833, 0.6149129719862041, 0.7769586140239726],
    [-0.6768985453019953, 0.33922123581195285, -0.31679320676473477],
    [-0.16248506244279537, -0.590693830239005, -5.987018630256734],
    [-0.6844952984798525, 0.5343168091987449, -1.1386093291325319],
    [0.18178895126181105, 0.29920403649866334, -1.7548682898501915],
    [0.3873740332008282, 0.569467572321245, -0.5621285298503831],
    [0.3305901367981101, -0.49840246074665356, -5.8836633975485],
    [-0.4210268820052488, 0.354749764786884, -8.019504725774853],
    [0.47129155655986854, -0.48312160786295966, -7.840954558878694],
    [-0.623152029215771, -0.052183766372474905, -4.224809742379188],
    [-0.5932297480011613, -0.02004585044938445, -9.457017712584069],
    [0.2729136686352188, 0.005683741040059864, 0.1921311001985595],
    [-0.227172779418169, 0.1888369829046631, -5.366365360091896],
    [0.41443804032593823, -0.47267045364999516, -2.475888681258712],
    [0.2584613742103997, 0.024787598224750518, -0.3707921441028623],
    [-0.3603717701780308, -0.5351863814706755, -1.574321943177182],
    [0.00683798003910252, 0.2077222013898148, -4.782218462382062],
    [-0.5162376618725377, -0.07210106690818308, -6.599307471585132],
    [-0.03964752634500046, -0.3976314781652562, -1.365802219599218],
    [0.35925236068251776, 0.292822303231128, -2.3886766238261954],
    [0.6930058893854165, 0.36787950793981383, -4.942783379704195],
    [0.09395918862466057, 0.5837274377097457, -6.887556505205893],
    [0.32051453934069984, -0.6127613697931221, -6.546146442073065],
    [-0.36133667596426045, -0.32768248210393575, -5.5101530595543355],
    [0.10171354746080996, 0.12996056602403094, -0.9264228098244112],
    [-0.3694725056946144, 0.3447777380917183, 0.022613430362944498],
    [-0.09297762501972218, 0.1776266470528306, -6.8558642208642695],
    [0.34454359387842826, 0.31203028264368293, -4.618126395500169],
    [0.0716916454442571, -0.3442764979941235, -0.20047755394822797],
    [-0.590164753971956, -0.49426520644268807, 1.1161460987296894],
    [-0.12061846283329858, -0.6756225026996012, -8.720419842064931],
    [0.6587222243109112, 0.1471668040684898, -4.8105156466628145],
    [0.3952153202353941, 0.6984799001875222, -1.2480237310069608],
    [-0.5322160544233807, 0.4247052507875424, -2.1991243671716925],
    [-0.5502110048404704, -0.3953013713301336, -3.3942877408241774],
    [0.034541483878778756, 0.24024651070673098, -6.074555486115116],
    [0.35540251793207633, 0.1419950765775071, -2.373554044656876],
    [0.06365472869361899, 0.6855105142529665, -5.867676589511845],
    [0.26836556037903625, -0.14610378620192588, -6.301672788054107],
    [0.3610582125060411, -0.38253831668631255, -5.464556448984345],
    [0.33108613048650204, -0.002765245107158476, -0.6138792570885814],
    [-0.5674121514510042, -0.4852494157162171, -7.612649803706759],
    [-0.5501750041477553, -0.47161324119625436, -0.4283173656089039],
    [0.48154794632436215, -0.4056055367352982, -4.058013959853834],
    [0.5148839060239341, -0.3031509456593322, -0.9672649471993948],
    [-0.3828730001319229, -0.06651584356317586, -1.5944587268963266],
    [0.45742374616755765, 0.3846316189852783, -0.2792967392552015],
    [0.15138714937776387, 0.021243758727403694, -7.255287219969825],
    [0.6747686148576839, 0.4292783517409875, -2.9711937705614027],
    [-0.37348449074895435, 0.5532263926576866, -2.482993830527402],
    [0.4871067282272228, -0.08797455286655376, -6.886923551624],
    [-0.17139663371181946, -0.3519436202983911, -5.339709835883115],
    [-0.5106293656563006, -0.18773808287913052, -2.6223813496804165],
    [-0.2535718334310802, -0.11992208043907693, -3.9954203496447134],
    [-0.21392712362225413, 0.10031619530867797, -4.3052575982783825],
    [-0.43726329273898135, -0.3871475256202672, -7.348118399973358],
    [0.3199405324541966, -0.5008894659962198, -2.6681769507103623],
    [0.29192629636074563, 0.2419558947398862, -7.919200178571084],
    [0.13428540345596274, -0.4592124868376073, -2.7723924171333776],
    [-0.1761929466502966, 0.09736184971701078, -3.4617000574794323],
    [0.5166474302626702, 0.46203810780969357, -4.156007448187111],
    [0.3431081002556322, -0.09345452130454135, -9.249031098034779],
  ];

  useLayoutEffect(() => {
    let position = [];
    const cols = 12;
    const row = 12;

    for (let i = -12; i < row; i++) {
      for (let j = -12; j < cols; j++) {
        position.push([
          Math.random() * 1.4 - 0.7,
          Math.random() * 1.4 - 0.7,
          Math.random() * -9.9 + Math.random() * 3,
        ]);
      }
    }
    console.log(position);
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  return (
    <>
      <div ref={el} className={"h-[100%] aspect-square " + className}>
        {children}
      </div>
      <UseCanvas>
        <ScrollScene track={el}>
          {(props) => (
            <group {...props}>
              <mesh position={[0, 0, -10]} ref={geometry}>
                <planeGeometry args={[10, 10, 16, 16]} />
                <MeshDistortMaterial speed={5} distort={0}>
                  <GradientTexture
                    stops={[0, 1]} // As many stops as you want
                    colors={["#e0363e", "#010101"]} // Colors need to match the number of stops
                    rotation={0.5}
                  />
                </MeshDistortMaterial>
              </mesh>
              {shperes.map((sphere) => {
                return (
                  <>
                    <mesh position={[sphere[0], sphere[1], sphere[2]]}>
                      <sphereGeometry
                        args={[
                          0.01 * Math.abs(3 / (Math.abs(sphere[2]) + 1)),
                          25,
                          25,
                        ]}
                      ></sphereGeometry>
                      <meshStandardMaterial color="red"></meshStandardMaterial>
                    </mesh>
                  </>
                );
              })}
            </group>
          )}
        </ScrollScene>
      </UseCanvas>
    </>
  );
}
